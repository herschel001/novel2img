# Novel2Img - AI生图浏览器插件需求文档

## 📋 文档信息

- **项目名称**: Novel2Img - AI生图浏览器插件
- **版本**: v1.0.0
- **创建日期**: 2024-08-28
- **文档类型**: 产品需求文档 (PRD)
- **目标用户**: 创作者、设计师、内容创造者

## 🎯 项目概述

### 1.1 项目背景
随着AI图片生成技术的快速发展，创作者在浏览网页时经常需要快速生成配图或灵感图片。现有的AI生图工具大多需要切换到专门的网站或应用，打断了用户的工作流程。Novel2Img旨在将AI生图功能无缝集成到浏览器中，让用户在任何网页上都能便捷地生成图片。

### 1.2 产品定位
一个集成多种AI图片生成服务的Chrome浏览器插件，为创作者和设计师提供无缝的浏览器内图片生成体验。

### 1.3 核心价值
- **无缝集成**: 在任何网页上都能快速生成图片
- **多服务支持**: 集成多种主流AI生图服务
- **简单易用**: 提供直观的用户界面和操作流程
- **隐私安全**: 本地存储敏感信息，保护用户隐私

## 👥 目标用户群体

### 2.1 主要用户
- **内容创作者**: 需要为文章、博客配图的作者
- **UI/UX设计师**: 需要快速生成设计灵感图的设计师
- **市场营销人员**: 需要制作社交媒体内容的营销专员
- **学生和研究人员**: 需要为论文、报告配图的学术工作者

### 2.2 用户画像
- **年龄**: 20-45岁
- **职业**: 创意工作者、知识工作者
- **技能水平**: 具备基本的浏览器使用能力
- **使用场景**: 日常办公、创作写作、学习研究

## 🎯 功能需求

### 3.1 核心功能需求

#### 3.1.1 图片生成功能
**功能描述**: 用户输入文字描述，系统调用AI服务一次生成3张图片，用户可选择喜欢的一张

**详细需求**:
- 支持中文和英文提示词输入
- 支持多种图片尺寸：512x512、1024x1024、768x512、512x768
- 支持选择不同AI模型（目前仅支持千问生图）
- 生成过程显示实时进度
- 生成完成后显示3张预览图供用户选择
- 用户可选择下载到本地或复制图片到剪贴板

**验收标准**:
- 提示词输入字符限制：1-500字符
- 图片生成成功率 ≥ 95%
- 平均生成时间 ≤ 30秒
- 同时生成3张图片供用户选择

#### 3.1.2 图片复制功能
**功能描述**: 用户可以将选中的图片一键复制到系统剪贴板，然后在任意应用中粘贴使用

**详细需求**:
- 支持使用现代浏览器的 Clipboard API
- 将图片数据直接复制到剪贴板
- 兼容性降级：不支持时复制图片链接
- 提供明确的操作反馈和状态提示
- 支持在各种编辑器中粘贴使用

**验收标准**:
- 图片复制成功率 ≥ 95%
- 支持主流现代浏览器（Chrome 88+）
- 提供明确的成功/失败反馈
- 用户操作简单直观，一键完成

#### 3.1.3 插件入口
**功能描述**: 提供主要的图片生成入口

**详细需求**:
- **插件弹窗**: 点击浏览器工具栏图标打开主界面

**验收标准**:
- 插件弹窗能正常显示和使用

#### 3.1.3 API服务集成
**功能描述**: 集成多种AI图片生成服务

**详细需求**:
- **魔搭（ModelScope）API集成**
  - 支持Qwen/Qwen-Image模型
  - 实现异步调用机制
- **扩展性设计**: 为未来集成其他服务预留接口

**验收标准**:
- API调用成功率 ≥ 99%
- 支持API密钥配置和验证
- 具备完善的错误处理机制

### 3.2 辅助功能需求

#### 3.2.1 配置管理
**功能描述**: 用户可以配置和管理插件设置

**详细需求**:
- API密钥配置和存储

**验收标准**:
- 配置信息安全存储在本地
- 设置修改后立即生效
- 支持配置重置功能

#### 3.2.2 历史记录管理
**功能描述**: 记录和管理用户的图片生成历史

**详细需求**:
- 记录生成的提示词和参数
- 显示生成时间和状态
- 支持重新下载历史图片
- 支持删除历史记录

**验收标准**:
- 最多保存100条历史记录
- 历史记录按时间倒序排列
- 支持按关键词搜索历史

#### 3.2.3 状态持久化功能
**功能描述**: 保存用户的生成状态，在切换标签页或关闭浏览器后能够恢复工作状态

**详细需求**:
- **生成状态保存**: 生成开始时自动保存提示词、参数和开始时间
- **结果状态保存**: 生成完成时保存图片URL、耗时和完成时间
- **智能状态恢复**: 插件打开时自动检测并恢复保存的状态
- **进度显示恢复**: 恢复生成中状态时显示已耗时间
- **超时检测**: 超过5分钟的生成任务自动标记为失败
- **自动清理**: 30分钟后自动清理过期状态
- **版本兼容**: 支持状态数据的版本管理和升级兼容

**验收标准**:
- 状态保存成功率 ≥ 99%
- 状态恢复成功率 ≥ 95%
- 支持在生成中、生成完成两种状态下的恢复
- 超时检测精度 ± 30秒
- 自动清理机制正常工作

## 🎨 界面设计需求

### 4.1 设计原则
- **简洁直观**: 界面简洁，操作流程直观
- **响应式设计**: 适配不同屏幕尺寸
- **品牌一致性**: 保持视觉风格统一
- **无障碍访问**: 遵循Web无障碍设计标准

### 4.2 界面组件需求

#### 4.2.1 插件弹窗界面
**尺寸要求**: 宽度400px，高度600px
**主要元素**:
- 顶部：插件标题和设置按钮
- 中部：提示词输入区域和参数选择
- 底部：生成按钮和进度显示
- 侧栏：历史记录列表

**交互要求**:
- 支持键盘快捷键操作
- 实时显示字符计数
- 参数修改实时预览

### 4.3 视觉设计要求
- **主色调**: 蓝色系（#007acc）
- **辅助色**: 绿色（成功）、橙色（警告）、红色（错误）
- **字体**: 系统默认字体，确保跨平台兼容
- **图标**: 使用Emoji或简洁的SVG图标

## 🔧 技术需求

### 5.1 技术架构要求

#### 5.1.1 插件架构
- **Manifest版本**: V3
- **目标浏览器**: Chrome 88+
- **兼容性**: 支持现代Chromium内核浏览器

#### 5.1.2 核心组件
- **Background Script**: 处理API调用和数据管理
- **Popup**: 主要用户界面，支持多图选择和复制功能

### 5.2 性能要求
- **启动时间**: 插件加载时间 ≤ 2秒
- **响应时间**: 界面操作响应时间 ≤ 500ms
- **内存占用**: 插件运行时内存占用 ≤ 50MB
- **网络优化**: 支持请求缓存和重试机制

### 5.3 安全要求
- **数据加密**: API密钥本地加密存储
- **权限最小化**: 仅申请必要的浏览器权限
- **内容安全**: 防止XSS攻击和代码注入
- **隐私保护**: 不收集用户个人信息

### 5.4 兼容性要求
- **浏览器兼容**: Chrome 88+, Edge 88+
- **操作系统**: Windows 10+, macOS 10.14+, Linux
- **屏幕分辨率**: 支持1280x720以上分辨率

## 📊 API集成需求

### 6.1 魔搭API集成
**API端点**: https://api-inference.modelscope.cn/v1/images/generations
**认证方式**: Bearer Token
**支持功能**:
- 异步图片生成
- 任务状态查询
- 多种模型选择

### 6.2 API调用规范
- **请求频率**: 每分钟最多10次请求
- **超时设置**: 请求超时30秒，任务超时5分钟
- **错误处理**: 完整的错误码处理和用户友好提示
- **重试机制**: 网络错误自动重试，最多3次

### 6.3 扩展性设计
- **接口抽象**: 设计通用的API调用接口
- **配置灵活**: 支持不同服务的参数配置
- **插件化**: 新服务可通过配置文件快速集成

## 🔒 权限需求

### 7.1 必需权限
- **activeTab**: 访问当前活动标签页内容
- **storage**: 本地存储用户配置和历史记录
- **scripting**: 向页面注入内容脚本
- **downloads**: 下载生成的图片文件

### 7.2 可选权限
- **notifications**: 显示生成完成通知（用户可选）
- **background**: 后台处理任务（如需要）

### 7.3 主机权限
- **ModelScope API**: https://api-inference.modelscope.cn/*
- **图片资源**: 允许访问生成的图片URL

## 📈 质量需求

### 8.1 性能指标
- **响应时间**: 
  - 界面操作响应 ≤ 500ms
  - API调用响应 ≤ 30s
  - 图片下载完成 ≤ 10s
- **成功率**:
  - 插件加载成功率 ≥ 99%
  - 图片生成成功率 ≥ 95%
  - API调用成功率 ≥ 99%

### 8.2 可用性要求
- **易学性**: 新用户5分钟内掌握基本操作
- **易用性**: 常用操作不超过3次点击
- **错误恢复**: 提供清晰的错误提示和恢复建议

### 8.3 可靠性要求
- **稳定性**: 连续运行24小时无崩溃
- **数据安全**: 配置数据不丢失
- **异常处理**: 网络异常时优雅降级

## 🚀 版本规划

### 9.1 v1.0.0 (MVP版本)
**发布时间**: 2024-08-28
**核心功能**:
- 基础图片生成功能
- 魔搭API集成
- 插件弹窗界面
- 基础配置管理

### 9.2 v1.1.0 (功能增强版)
**预计发布**: 2024-10-15
**新增功能**:
- 多AI服务支持
- 历史记录管理
- 高级参数配置
- 批量生成功能

### 9.3 v1.2.0 (专业版)
**预计发布**: 2024-12-20
**新增功能**:
- 图片编辑功能
- 云存储集成
- 智能提示建议
- 使用分析统计

## 📝 验收标准

### 10.1 功能验收
- [ ] 所有核心功能正常工作
- [ ] 三种访问方式均可用
- [ ] API集成稳定可靠
- [ ] 配置管理完整有效

### 10.2 性能验收
- [ ] 满足所有性能指标要求
- [ ] 通过压力测试
- [ ] 内存使用在合理范围
- [ ] 网络请求优化有效

### 10.3 兼容性验收
- [ ] 支持的浏览器版本正常运行
- [ ] 不同操作系统表现一致
- [ ] 响应式设计适配良好

### 10.4 安全验收
- [ ] 通过安全扫描测试
- [ ] 权限使用合理必要
- [ ] 数据存储加密安全
- [ ] 隐私保护措施到位

## 📋 项目里程碑

### 里程碑1: 技术架构搭建 (Week 1-2)
- 完成Manifest V3配置
- 搭建基础项目结构
- 实现API调用框架

### 里程碑2: 核心功能开发 (Week 3-4)
- 实现图片生成功能
- 完成魔搭API集成
- 开发用户界面

### 里程碑3: 交互功能完善 (Week 5-6)
- 实现三种访问入口
- 完成配置管理
- 添加错误处理

### 里程碑4: 测试与优化 (Week 7-8)
- 功能测试和性能优化
- 用户体验测试
- 安全测试和修复

### 里程碑5: 发布准备 (Week 9-10)
- 文档完善
- 打包发布
- 用户反馈收集

## 📚 参考文档

- [Chrome扩展程序开发指南](https://developer.chrome.com/docs/extensions/)
- [Manifest V3规范](https://developer.chrome.com/docs/extensions/mv3/)
- [魔搭API文档](https://modelscope.cn/docs)
- [Web无障碍设计指南](https://www.w3.org/WAI/WCAG21/quickref/)

---

**文档状态**: 初版完成
**更新频率**: 根据项目进展定期更新
**审批状态**: 待产品经理和技术负责人审批